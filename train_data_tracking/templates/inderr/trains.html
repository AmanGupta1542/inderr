{% extends "inderr/base.html" %}
{% load static %}
{% block content %}

<div class="container-xxl flex-grow-1 container-p-y">
    <div class="row" style="background-color: white;">
        <div class="col-lg-12 my-4 order-0">
            <h2 class="my-3">Trains</h2>
            <form method="get">
                <input type="text" name="search" value="{{ search_query }}" placeholder="Search...">
                <select name="order_by">
                    <option value="title" {% if order_by == 'title' %}selected{% endif %}>Title</option>
                    <option value="-title" {% if order_by == '-title' %}selected{% endif %}>Title (descending)</option>
                    <!-- Add more sorting options here -->
                </select>
                <button type="submit">Update</button>
            </form>
        </div>
        <div class="col-lg-12 mb-4 order-0">

            
                <!-- <div class="item">
                    <h2>{{ item.name }}</h2>
                    <p>{{ item.number }}</p>
                </div> -->
            <table class="table table-bordered table-hover table-striped">
                <thead>
                    <tr>
                        <th scope="col">SN</th>
                        <th scope="col">Train No</th>
                        <th scope="col">Name</th>
                        <th scope="col">From Station</th>
                        <th scope="col">To Station</th>
                        <th scope="col">Details</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in page_obj.object_list %}
                        <tr>
                            <td scope="row">{{ forloop.counter }}</td>
                            <td>
                                <a href="{% url 'train_details' train_number=item.number %}" >{{ item.number }}</a>
                            </td>
                            <td>{{ item.name }}</td>
                            <td>{{ item.from_station.name }}</td>
                            <td>{{ item.to_station.name }}</td>
                            <td>
                                <a href="{% url 'train_details' train_number=item.number %}">
                                    <button type="button" class="btn btn-icon btn-outline-primary">
                                        <span class="tf-icons bx bx-link-external"></span>
                                    </button>
                                </a>
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
            
            
            <div class="pagination">
                {% if page_obj.has_previous %}
                    <a href="?page=1">« First</a>
                    <a href="?page={{ page_obj.previous_page_number }}">Previous</a>
                {% endif %}
            
                <span class="current-page">Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</span>
            
                {% if page_obj.has_next %}
                    <a href="?page={{ page_obj.next_page_number }}">Next</a>
                    <a href="?page={{ page_obj.paginator.num_pages }}">Last »</a>
                {% endif %}
            </div>
            
            <div class="pagination">
                {% if page_obj.has_previous %}
                    <!-- <a href="?p=1">« First</a>
                    <a href="?p={{ page_obj.previous_page_number }}">Previous</a> -->
                {% endif %}
            
                <!-- <span class="current-page">Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</span> -->
            
                {% if page_obj.has_next %}
                    <!-- <a href="?p={{ page_obj.next_page_number }}">Next</a>
                    <a href="?p={{ page_obj.paginator.num_pages }}">Last »</a> -->
                {% endif %}
            </div>
            
            {% with request.GET.urlencode as query_params %}
                {% if page_obj.has_previous %}
                    <!-- <a href="?{{ query_params }}&page=1">« First</a>
                    <a href="?{{ query_params }}&page={{ page_obj.previous_page_number }}">Previous</a> -->
                {% endif %}
            
                <!-- <span class="current-page">Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</span> -->
            
                {% if page_obj.has_next %}
                    <!-- <a href="?{{ query_params }}&page={{ page_obj.next_page_number }}">Next</a>
                    <a href="?{{ query_params }}&page={{ page_obj.paginator.num_pages }}">Last »</a> -->
                {% endif %}
            {% endwith %}
            
            
            

        </div>
    </div>
</div>

{% endblock %}


{% block script %}
<!-- Include jQuery library -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script>
$(document).ready(function() {
    function loadPage(pageNumber) {
        $.ajax({
            url: '/path/to/your/view/',
            data: {
                'page': pageNumber,
                // Include any other query parameters you want to pass
            },
            success: function(data) {
                // Replace the content with the new data (assuming it's wrapped in a div with the class "content")
                $('.content').html(data);
            }
        });
    }

    // Attach click event handlers to the pagination links
    $(document).on('click', '.pagination a', function(e) {
        e.preventDefault();
        const pageNumber = $(this).data('page-number');
        loadPage(pageNumber);
    });
});
</script>

{% endblock %}